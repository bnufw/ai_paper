# Proposal: add-paper-notes

## 概述

为学术论文阅读器增加**笔记功能**，每篇论文对应一篇 Markdown 格式的笔记。笔记的初始版本由 AI（Gemini）根据预定义提示词自动生成，用户可以在此基础上进行编辑和完善。

## 动机

当前系统支持论文阅读和 AI 对话，但缺乏结构化的论文笔记能力：
- 用户无法保存对论文的总结和理解
- AI 对话是碎片化的，缺乏系统性的论文分析
- 每次重新阅读论文时需要重复理解过程

通过自动生成结构化笔记，可以：
1. 快速获得论文的核心内容摘要
2. 保留用户的个人批注和见解
3. 便于后续复习和引用

## 目标

1. **一对一关系**：每篇论文有且仅有一篇对应笔记
2. **AI 自动生成**：使用 Gemini API 根据 `prompts/note.md` 提示词生成初始笔记
3. **用户可编辑**：生成后用户可以自由编辑笔记内容
4. **本地存储**：笔记以 `note.md` 文件形式存储在论文目录中

## 范围

### 包含

- 笔记生成服务（调用 Gemini API）
- 笔记存储/读取（本地文件系统）
- 笔记查看/编辑界面（独立标签页）
- 论文/笔记切换交互

### 不包含

- 笔记导出为其他格式（PDF、Word等）
- 笔记模板自定义
- 多笔记版本管理
- 笔记间的关联和引用

## 风险与缓解

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| 论文内容过长导致 API 调用失败 | 高 | 复用现有的内容截断逻辑（50KB限制） |
| 笔记生成耗时较长 | 中 | 显示生成进度，支持流式输出 |
| 旧论文无本地路径无法存储笔记 | 中 | 仅支持新版本（有 localPath）的论文 |

## 相关变更

- **新增 Spec**: `paper-notes` - 论文笔记功能规格
